
## מסמך סטטוס והמשך פיתוח: סימולטור תשאול AI

**גרסה:** 1.6.3 (Trainer Interruption UI - In Progress)
**תאריך:** 25 ביולי 2024

### 1. מבוא

מסמך זה מפרט את ההתקדמות בפיתוח אפליקציית סימולטור התשאול מבוסס הבינה המלאכותית. הוא סוקר את התכונות והפונקציונליות שכבר מומשו בהצלחה, ומתווה את המשימות הנותרות, השיפורים הנדרשים ואפשרויות הפיתוח העתידיות. המטרה היא לספק תמונה ברורה של מצב הפרויקט הנוכחי ולהנחות את המשך העבודה, **במטרה להעלות את האפליקציה לרמה מסחרית מובילה.**

### 2. סטטוס ביצוע תוכנית השיפורים

#### שלב 1: ליטוש UI/UX בסיסי וחידוד הנחיות AI ראשוני - **הושלם**
*   **שיפור רכיב `Button.tsx`**: אנימציות מעבר, `focus-visible`, תמיכה באייקונים - **הושלם**.
*   **שיפור רכיב `Modal.tsx`**: אנימציות מעבר לפתיחה/סגירה - **הושלם**. (ניהול פוקוס שופר בשלב מאוחר יותר)
*   **חידוד הנחיות AI ב-`constants.ts`**:
    *   `UI_TEXT.scenarioSystemPromptTemplate`: התאמת התנהגות AI לרמת קושי - **הושלם**.
    *   `UI_TEXT.generateScenarioPrompt`: דרישה לפרטים ייחודיים ועשירים יותר (עבר פלילי, מידע מודיעיני), הימנעות מתשובות גנריות - **הושלם**.
    *   `UI_TEXT.agentBaseSystemPromptPlaceholder`: טקסט זמני מנחה יותר - **הושלם**.
*   **הוספת אייקונים (SVG) לכפתורים מרכזיים:** **הושלם** (אייקונים בסיסיים שולבו, אייקונים נוספים נוספו ב-TraineeView ו-TrainerView).

#### שלב 2: ליטוש UI/UX מתקדם, שיפורי נגישות ראשוניים, ויכולות בסיסיות לחניך - **הושלם**
*   **ליטוש עיצובי נוסף והוספת אייקונים:**
    *   שילוב אייקוני SVG בסיסיים נוספים ב-`TraineeView.tsx` ו-`TrainerView.tsx` - **הושלם**.
    *   שיפורים קלים בטיפוגרפיה ובריווח - **הושלם**.
*   **שיפורי נגישות (Accessibility):**
    *   הוספת `aria-label` ו-`role` במקומות קריטיים - **הושלם**.
    *   בדיקה ראשונית של ניווט מקלדת - **שופר משמעותית** (כולל ניהול פוקוס במודלים, לכידת פוקוס והחזרתו).
*   **יכולות בסיסיות לחניך (`TraineeView.tsx`):**
    *   **"יומן חקירה" (Investigation Log):** הוספת `textarea`. **תוקן באג קפיצת פוקוס.** - **הושלם**.
    *   **הצגת "מטרות חקירה" (`investigationGoals`):** עדכון טיפוסים, שירות AI, קבועים, והצגה בממשק - **הושלם**.

#### שלב 3: העמקת ליבת ה-AI, חוויית משתמש מתקדמת, והרחבת תכונות - **הושלם במלואו**

*   **העמקת ליבת ה-AI והסימולציה (`GeminiService.ts`, `constants.ts`):**
    *   בחינת הרחבת זיכרון הקשר (Context Management) ל-AI - **הושלם** (הגדלת היסטוריה נשלחת ל-AI ל-10 הודעות).
    *   הנחיית AI לשינוי התנהגות הדרגתי במהלך חקירה (שימוש ב-`INVESTIGATION_PROGRESS_HINT`) - **הושלם**.
    *   הוספת "מניע בסיסי" (Underlying Motivation) לדמות ה-AI - **הושלם**.
    *   העמקת פרסונת ה-AI: שיפור הנחיה לשילוב "תכונות אישיות" (`personalityTraits`) עם מניע ורמת קושי - **הושלם**.
    *   חידוד הנחיית משוב AI: הבטחה שה-AI מתייחס מפורשות לקלט החניך - **הושלם**.
    *   **הנחיות AI לאווטאר (`directives`):** הנחיית ה-AI לשימוש בהן שופרה לעידוד שימוש עקבי ומתאים יותר. **הושלם** (ההנחיה ב-`constants.ts` עודכנה עם רשימת אפשרויות ברורה ודוגמאות).
    *   **חידוד הנחיות AI לשימוש בכלים (Tools) וב-JSON:** ההנחיה ב-`constants.ts` (`UI_TEXT.scenarioSystemPromptTemplate`) חודדה כדי להדגיש את החובה להשיב תמיד בפורמט JSON תקין עם שדה `textResponse`, ולפרט את התהליך הדו-שלבי בעת שימוש בכלים (תגובה ראשונית, קבלת תוצאת כלי, תגובה סופית). **הושלם**.
*   **חוויית משתמש (UX) וממשק משתמש (UI):**
    *   הוספת בועות עזרה (Tooltips) באמצעות מאפיין `title` לרכיבים אינטראקטיביים מרכזיים - **הושלם**.
    *   שיפור ויזואלי להודעות מערכת ספציфиות (התערבות מדריך, רמזים) ב-`ChatBubble.tsx` - **הושלם**.
    *   שיפור נגישות בניווט מקלדת וניהול פוקוס (בעיקר במודלים) - **הושלם**.
    *   תיקון באג איבוד פוקוס בשדה הקלט של החניך (`TraineeView.tsx`) בזמן הקלדה - **הושלם**.
    *   שיפור נראות הלשונית הפעילה בממשק המדריך (`TrainerView.tsx`) - **הושלם**.
    *   **שיפור ויזואלי ושימושיות של "יומן חקירה" (`TraineeView.tsx`)** - **הושלם** (נוסף אייקון חיפוש, כפתור "נקה יומן" עם מודל אישור).
*   **סט תכונות (Features) למדריך (`TrainerView.tsx`):**
    *   שיפור תצוגת היסטוריית פקודות מדריך ("לחישות") והבטחת שמירה אמינה שלה עם הסשן - **הושלם**.
    *   הוספת תפקיד "מנהל מערכת" עם הרשאות מורחבות (ניהול משתמשים, סוכנים, הגדרות) - **הושלם**.
*   **אינטראקציה קולית (`TraineeView.tsx`, `live-audio.ts`, `live-audio-visuals-3d.ts`):**
    *   שיחה קולית חיה (`gdm-live-audio`): הלוגיקה המרכזית ברכיב עודכנה לשימוש ב-`client.live.connect()` API (מבוסס על דוגמה עובדת) ומוכנה לבדיקות אינטגרציה מקיפות. - **הושלם**.
    *   רכיב ויזואליזציה (`gdm-live-audio-visuals-3d`): בוצעו שיפורים וייצוב לרכיב, כולל טיפול טוב יותר במקורות אודיו וניקוי משאבים. כעת מגיב להנחיות אווטאר מה-AI. - **הושלם**.
    *   איכות TTS (הקראת טקסט): איכות הקול הנוכחית מוגבלת ע"י Web Speech API. שיפור מהותי דורש שירותים חיצוניים ו-Backend (נוסף למפת דרכים עתידית).
    *   **שיפור חווית משתמש וטיפול בשגיאות בפיצ'רים קוליים:** נוספו הודעות משוב מפורטות יותר למשתמש ב-`TraineeView.tsx` דרך `addMessageToChatInternal` במעבר בין שלבי החיבור השונים ובמקרה של שגיאות, תוך שימוש בטקסטים ייעודיים מ-`UI_TEXT`. **הושלם**.

#### שלב 1.5.0-1.6.1: הרחבת ניהול סוכני AI (בהשראת MyGPTs) ומסייע AI איטרטיבי - **הושלם**
*   **ממשק ניהול סוכנים (`TrainerView.tsx`):**
    *   **הושלם:** עדכון מודל יצירה/עריכת סוכן עם חלוקה ללשוניות (הגדרות, מסייע AI, ידע, פותחי שיחה, יכולות, פעולות).
    *   **הושלם:** ממשק ראשוני ל-"ידע" (העלאת קבצים דמה), "יכולות" (מתגים), "פעולות" (תצוגת כלים קיימים), "מודל מומלץ" (בחירה).
    *   **הושלם:** הוספת לשונית "פותחי שיחה" עם `textarea` לשמירת הצעות.
    *   **הושלם:** הוספת לשונית "מסייע AI" עם יכולת לקבל תיאור חופשי מהמשתמש.
*   **מסייע AI ליצירת סוכן (גרסה ראשונית):**
    *   **הושלם:** פונקציה ב-`GeminiService.ts` המקבלת תיאור ומחזירה הצעות לשם, תיאור, הנחיית בסיס ותכונות אישיות.
    *   **הושלם:** הנחיית מערכת ייעודית (`UI_TEXT.generateAgentConfigPrompt`) למסייע ה-AI.
*   **מסייע AI איטרטיבי ליצירת סוכן:**
    *   **הושלם:** שינוי זרימת העבודה בלשונית "מסייע AI" כך שהצעות ה-AI יוצגו במסייע, וניתן להחיל אותן על לשונית "הגדרות" או לבקש שיפור.
    *   **הושלם:** פונקציה חדשה ב-`GeminiService.ts` (`refineAgentConfiguration`) המקבלת הצעות קיימות ובקשת שיפור, ומחזירה סט חדש של הצעות.
    *   **הושלם:** הנחיית מערכת ייעודית (`UI_TEXT.refineAgentConfigPrompt`) לשיפור הצעות.
*   **עדכון טיפוסים (`types.ts`):**
    *   **הושלם:** הרחבת `AIAgent` ו-`LoadedAIAgent` עם שדות עבור `knowledgeFileReferences` (דמה), `capabilities`, `recommendedModel`, `conversationStarters`.
*   **עדכון לוגיקה (`constants.ts`):**
    *   **הושלם:** התאמת `loadAiAgents` לשדות החדשים.

#### שלב 1.6.2: העמקת ריאליזם AI, שיפור משוב והפרעות - **הושלם**
*   **ריאליזם ודינמיות של סוכני AI (המשך):**
    *   **הושלם:** הוספת שדה `behavioralDynamics` לפרופיל הנחקר, כולל `potentialShifts` ו-`hiddenTruths`.
    *   **הושלם:** עדכון הנחיות יצירת התרחיש (`generateScenarioPrompt`) וההנחיה הראשית (`scenarioSystemPromptTemplate`) כדי לשלב את `behavioralDynamics` בהתנהגות ה-AI.
*   **משוב AI אבחוני ומעמיק (הרחבה מעבר לקיים):**
    *   **הושלם:** זיהוי והערכה של טקטיקות פסיכולוגיות והטיות קוגניטיביות: עדכון `UI_TEXT.generateFeedbackPromptTemplate`.
    *   **הושלם:** הצעות לשיפור מותאמות אישית ברמת הטקטיקה והאסטרטגיה: עדכון `UI_TEXT.generateFeedbackPromptTemplate`.
*   **שימוש מתקדם בכלים (Tool Use):**
    *   **הושלם:** יצירת כלים מדומים נוספים: `SEARCH_INTERNAL_ARCHIVES`, `REQUEST_FORENSIC_ANALYSIS`. עדכון `types.ts`, `constants.ts`, `GeminiService.ts`.
*   **שילוב "הפרעות" ואירועים בלתי צפויים בסימולציה:**
    *   **הושלם:** הוספת פקודת התערבות חדשה למדריך: `TRIGGER_INTERRUPTION`. עדכון `types.ts`, `constants.ts`, `GeminiService.ts`, `TraineeView.tsx`.

#### שלב 1.6.3: השלמת ממשק מדריך להפרעות (השלב הנוכחי) - **בביצוע**
*   **(בביצוע)** ממשק מדריך (`TrainerView.tsx`): הוספת רכיבי UI לבחירת סוג הפרעה, הזנת פרטים, ושליחת פקודת הפרעה.

---

### 3. מפת דרכים מפורטת לשיפורים ושדרוגים (לקראת רמה 60-100)

להלן פירוט השיפורים המתוכננים, מחולקים לצירים מרכזיים.

#### 3.1. העמקת ליבת ה-AI והסימולציה **(מ-Level 35 ל-Level 50)**
*   **ריאליזם ודינמיות של סוכני AI:**
    *   **הושלם (בסיס):** פיתוח יכולת ל-AI לאמץ פרסונות עם עומק פסיכולוגי רב יותר, כולל מניעים נסתרים, סתירות פנימיות מתוחכמות (דרך `underlyingMotivation` ו-`behavioralDynamics`). נדרש ליטוש מתמיד של הנחיות ואיכות יצירת התרחישים.
*   **תרחישים אדפטיביים:**
    *   **(מתוכנן)** התאמת רמת הקושי והתפתחות התרחיש למיומנות החוקר.
    *   **(מתוכנן)** מערכת "השלכות" (Consequences Engine) לענפי עלילה שונים.
*   **משוב AI אבחוני ומעמיק (הרחבה מעבר לקיים):**
    *   **(הושלם)** זיהוי והערכה של טקטיקות פסיכולוגיות, הטיות קוגניטיביות.
    *   **(הושלם)** הצעות לשיפור מותאמות אישית ברמת הטקטיקה והאסטרטגיה.
*   **שימוש מתקדם בכלים (Tool Use):**
    *   **(הושלם)** יצירת כלים מדומים נוספים (`SEARCH_INTERNAL_ARCHIVES`, `REQUEST_FORENSIC_ANALYSIS`).
    *   **(מתוכנן)** שרשור קריאות לכלים (הבסיס הטכני קיים, דורש הנחיית AI מורכבת יותר).
*   **תמיכה בתשאול מרובה משתתפים:**
    *   **(מתוכנן)** תשאול מספר דמויות AI סדרתי.
    *   **(מתוכנן - מורכב יותר)** סימולציית חקירת צוות (שני חניכים מול AI אחד).
*   **(בביצוע - ממשק מדריך)** שילוב "הפרעות" ואירועים בלתי צפויים בסימולציה (דרך פקודת מדריך).

#### 3.2. חוויית משתמש (UX) וממשק משתמש (UI) – קפיצת מדרגה מקצועית **(מ-Level 30 ל-Level 50)**
*   **ליטוש עיצובי (Polish):**
    *   **(בביצוע - שיפורי טיפוגרפיה וריווח ראשוניים, עקביות אייקונים)** סקירה ושיפור של טיפוגרפיה, ריווח והיררכיה ויזואלית.
    *   **(בביצוע - שיפורי טיפוגרפיה וריווח ראשוניים, עקביות אייקונים)** המשך שימוש עקבי ואיכותי באייקונים (SVG) בכל חלקי הממשק.
*   **שיפור האינטואיטיביות:**
    *   **(מתוכנן)** פישוט ממשק התערבות המדריך.
    *   **(הושלם)** שיפור חווית יצירת ועריכת סוכני AI (מבנה לשוניות, מסייע AI).
*   **נגישות (Accessibility):**
    *   **(מתוכנן)** בדיקה מקיפה (אוטומטית וידנית) ועמידה בתקני WCAG AA.
    *   **(מתוכנן)** שיפור מקיף של ARIA Attributes.
    *   **(מתוכנן)** בדיקה ושיפור של ניגודיות צבעים.
*   **התאמה אישית (Personalization):**
    *   **(מתוכנן)** לוחות מחוונים מותאמים אישית.
    *   **(מתוכנן)** שמירת "הגדרות מועדפות" לסימולציות.
*   **לוקליזציה:**
    *   **(מתוכנן - אם נדרש)** תמיכה בשפות נוספות.

#### 3.3. סט תכונות (Features) – העשרה משמעותית **(מ-Level 30 ל-Level 55)**
*   **עבור החניך (`TraineeView`):**
    *   **(בוצע)** שיפור "יומן חקירה" (אייקון חיפוש, כפתור ניקוי). (אפשרות לתיוג והדגשת טקסט בחיפוש מתוכננות לעתיד).
    *   **(מתוכנן)** "נקודות מפתח" אינטראקטיביות במשוב (קישור לתמליל).
*   **עבור המדריך (`TrainerView`):**
    *   **(בוצע)** "בונה תרחישים" בסיסי (ידני, נשמר ב-`localStorage`).
    *   **(מתוכנן)** הרחבת אנליטיקות: גרפים פשוטים, זיהוי פרמטרים בעייתיים.
    *   **(מתוכנן - דורש Backend למימוש מלא)** מערכת ניהול תוכן (CMS) לתרחישים וסוכני AI, מאגר מרכזי, בקרת גרסאות.
    *   **(מתוכנן - דורש Backend למימוש מלא)** אנליטיקה ודיווח מתקדמים ברמת הארגון.
    *   **(מתוכנן - דורש Backend למימוש מלא)** ניהול ארגונים וצוותים, הקצאת תכנים.

#### 3.4. אודיו, ויזואליזציה ואימרסיביות **(מ-Level 15 ל-Level 35 בצד לקוח, Level 60+ עם פתרונות חיצוניים/Backend)**
*   **(בוצע)** בדיקות אינטגרציה מקיפות לרכיב `gdm-live-audio` ולהבטחת פעולה תקינה של `client.live.connect()`.
*   **שיפור `gdm-live-audio-visuals-3d` (כדור):**
    *   **(בוצע)** מגיב להנחיות אווטאר מה-AI.
    *   **(מתוכנן)** אנימציות אווטאר נוספות המופעלות על ידי `avatarGesture`/`avatarExpression`.
    *   **(מתוכנן)** בחינת שיידרים מתקדמים יותר, אפקטים של חלקיקים.
*   **אווטארים אנושיים וסביבות תלת-ממדיות:**
    *   **(מתוכנן - טווח ארוך, דורש טכנולוגיות נוספות/שירותים חיצוניים)** מעבר לדמויות תלת-ממדיות אנושיות.
    *   **(מתוכנן - טווח ארוך)** סביבות תשאול אימרסיביות תלת-ממדיות.
*   **שיפור איכות קול (TTS):**
    *   **(מתוכנן - נוכחי)** אפשרות למשתמש לבחור קול עברי זמין ב-Web Speech API.
    *   **(מתוכנן - טווח ארוך, דורש שירות חיצוני ו-Backend)** **שילוב שירותי TTS מבוססי ענן.**
*   **(בוצע)** אינדיקציות ויזואליות נוספות בצ'אט (למשל, "מקליד...").

#### 3.5. ניהול נתונים, יציבות וביצועים **(מ-Level 10 ל-Level 30 בצד לקוח, Level 60+ עם Backend)**
*   **טיפול בשגיאות (Error Handling):**
    *   **(בוצע)** משוב משתמש ברור יותר על שגיאות (במיוחד בפיצ'רים קוליים).
    *   **(מתוכנן)** מנגנון Retry פשוט לקריאות API.
*   **אופטימיזציה של `localStorage`:**
    *   **(בוצע)** אפשרות למדריך לנקות נתונים ישנים.
    *   **(מתוכנן)** בחינת אסטרטגיית שמירה חכמה יותר.
*   **אופטימיזציות React (שימוש ב-`React.memo`, `useCallback`, `useMemo`, פיצול רכיבים).**
*   **תשתית Backend ייעודית (קריטי למוצר מסחרי):**
    *   **(מתוכנן - טווח ארוך, חובה)** העברת נתונים קריטיים לבסיס נתונים מאובטח צד-שרת.
    *   **(מתוכנן - טווח ארוך, חובה)** אימות וניהול הרשאות מאובטח בצד השרת.
    *   **(מתוכנן - טווח ארוך, חובה)** הקמת Backend Proxy לאבטחת מפתח API של Gemini.
    *   **(מתוכנן - טווח ארוך)** ארכיטקטורת שרתים סקיילבילית.
    *   **(מתוכנן - טווח ארוך)** אבטחת מידע והצפנה.
    *   **(מתוכנן - טווח ארוך)** תהליכי CI/CD, ניטור והתראות, ניהול לוגים.

#### 3.6. איכות קוד, תחזוקתיות ובדיקות **(מ-Level 15 ל-Level 45)**
*   **הרחבת בדיקות (Testing):**
    *   **(מתוכנן)** כתיבת בדיקות יחידה (Unit Tests) עם Jest/Vitest ו-React Testing Library.
    *   **(מתוכנן - טווח ארוך)** בדיקות אינטגרציה ובדיקות E2E.
*   **תיעוד קוד (JSDoc).**
*   **Refactoring מתמשך.**

#### 3.7. תוכן והיבטים פדגוגיים (דורש מומחי תוכן)
*   **(מתוכנן - טווח ארוך)** שיתוף פעולה עם מומחי חקירות ופסיכולוגים.
*   **(מתוכנן - טווח ארוך)** פיתוח ספריית תרחישים מקצועית ומגוונת.
*   **(מתוכנן - טווח ארוך)** שילוב הסימולטור במסלולי הכשרה מוגדרים עם יעדי למידה.


### 4. סטטוס נוכחי של משימות פתוחות עיקריות (לאור התכנון החדש)

*   **יציבות ושיפור רכיב `gdm-live-audio`**: (בביצוע - לוגיקה מבוססת `client.live.connect()` הושלמה, **מוכן לבדיקות אינטגרציה מקיפות**)
*   **ניהול קבוע של סוכני AI (שרתי)**: (מתוכנן - כחלק מתשתית Backend)
*   **הרחבת יכולות האווטאר (מעבר לכדור)**: (מתוכנן - טווח ארוך)
*   **מערכת התערבות מדריך בזמן אמת מלאה (עם Backend)**: (מתוכנן - טווח ארוך)
*   **אבטחת מפתח API בייצור**: (מתוכנן - טווח ארוך, חובה Backend)
*   **מערך בדיקות מקיף**: (מתוכנן - כחלק מאיכות קוד)
*   **אסטרטגיית פריסה (Deployment)**: (מתוכנן - כחלק מתשתית Backend ו-DevOps)
*   **אופטימיזציות ביצועים**: (מתוכנן - כחלק מניה---)
